local TweenService = game:GetService("TweenService")
local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local UserInputService = game:GetService("UserInputService")
local Workspace = game:GetService("Workspace")
local CoreGui = game:GetService("CoreGui")
local Lighting = game:GetService("Lighting")

local player = Players.LocalPlayer
local mouse = player:GetMouse()
local camera = Workspace.CurrentCamera

-- Remote Event (Eğer oyun içinde mevcutsa çalışır)
local GuinRemote = game:GetService("ReplicatedStorage"):WaitForChild("GuinRemote", 5)

-- Renk Paleti (Brookhaven Temalı Neon Mor)
local THEME = {
    Main = Color3.fromRGB(20, 20, 30),
    Accent = Color3.fromRGB(160, 100, 255), -- Daha canlı mor
    Text = Color3.fromRGB(255, 255, 255),
    SecondaryText = Color3.fromRGB(170, 170, 170),
    Background = Color3.fromRGB(30, 30, 45),
    Outline = Color3.fromRGB(60, 50, 80),
    Red = Color3.fromRGB(255, 80, 80),
    Green = Color3.fromRGB(80, 255, 120)
}

-- Global Kontrol Değişkenleri
_G.Destruction = false
_G.AutoBuyHouse = false
_G.AutoAudio = false
_G.SpamItems = false
_G.Noclip = false
_G.RainbowSkin = false
_G.Fly = false
_G.MenuVisible = true
_G.SelectedAudio = "14145620056"

-- Anti-AFK
local virtualUser = game:GetService("VirtualUser")
player.Idled:Connect(function()
    virtualUser:CaptureController()
    virtualUser:ClickButton2(Vector2.new())
end)

-- GUI Koruma
local ScreenGui = Instance.new("ScreenGui")
ScreenGui.Name = "XenoHub_Brookhaven"
ScreenGui.ResetOnSpawn = false
ScreenGui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling

local function ProtectGUI(gui)
    if gethui then
        gui.Parent = gethui()
    elseif syn and syn.protect_gui then
        syn.protect_gui(gui)
        gui.Parent = CoreGui
    else
        gui.Parent = CoreGui
    end
end
ProtectGUI(ScreenGui)

-- Ana Çerçeve
local MainFrame = Instance.new("Frame")
MainFrame.Name = "MainFrame"
MainFrame.Size = UDim2.new(0, 650, 0, 480)
MainFrame.Position = UDim2.new(0.5, -325, 0.5, -240)
MainFrame.BackgroundColor3 = THEME.Main
MainFrame.BorderSizePixel = 0
MainFrame.ClipsDescendants = true
MainFrame.Parent = ScreenGui

local UICorner = Instance.new("UICorner")
UICorner.CornerRadius = UDim.new(0, 14)
UICorner.Parent = MainFrame

local UIStroke = Instance.new("UIStroke")
UIStroke.Thickness = 2
UIStroke.Color = THEME.Accent
UIStroke.Transparency = 0.3
UIStroke.Parent = MainFrame

-- Yan Menü
local Sidebar = Instance.new("Frame")
Sidebar.Name = "Sidebar"
Sidebar.Size = UDim2.new(0, 190, 1, 0)
Sidebar.BackgroundColor3 = THEME.Background
Sidebar.BorderSizePixel = 0
Sidebar.Parent = MainFrame
Instance.new("UICorner", Sidebar).CornerRadius = UDim.new(0, 14)

-- Başlık
local Title = Instance.new("TextLabel")
Title.Size = UDim2.new(1, 0, 0, 70)
Title.BackgroundTransparency = 1
Title.Text = "BROOKHAVEN\nXENOHUB"
Title.TextColor3 = THEME.Accent
Title.TextSize = 22
Title.Font = Enum.Font.GothamBlack
Title.Parent = Sidebar

-- Menü Listesi
local ButtonList = Instance.new("ScrollingFrame")
ButtonList.Size = UDim2.new(1, -10, 1, -120)
ButtonList.Position = UDim2.new(0, 5, 0, 80)
ButtonList.BackgroundTransparency = 1
ButtonList.ScrollBarThickness = 0
ButtonList.Parent = Sidebar
local UIList = Instance.new("UIListLayout")
UIList.Padding = UDim.new(0, 8)
UIList.Parent = ButtonList

-- Alt Bilgi
local KeyInfo = Instance.new("TextLabel")
KeyInfo.Size = UDim2.new(1, 0, 0, 40)
KeyInfo.Position = UDim2.new(0, 0, 1, -45)
KeyInfo.BackgroundTransparency = 1
KeyInfo.Text = "Menü: [Right Shift]"
KeyInfo.TextColor3 = THEME.SecondaryText
KeyInfo.TextSize = 12
KeyInfo.Font = Enum.Font.Gotham
KeyInfo.Parent = Sidebar

-- İçerik Alanı
local Container = Instance.new("Frame")
Container.Name = "Container"
Container.Size = UDim2.new(1, -210, 1, -20)
Container.Position = UDim2.new(0, 200, 0, 10)
Container.BackgroundTransparency = 1
Container.Parent = MainFrame

-- Yardımcı Fonksiyonlar
local function createTab(name)
    local TabButton = Instance.new("TextButton")
    TabButton.Size = UDim2.new(1, 0, 0, 45)
    TabButton.BackgroundColor3 = THEME.Main
    TabButton.BorderSizePixel = 0
    TabButton.Text = "   " .. name
    TabButton.TextColor3 = THEME.SecondaryText
    TabButton.TextSize = 14
    TabButton.Font = Enum.Font.GothamSemibold
    TabButton.TextXAlignment = Enum.TextXAlignment.Left
    TabButton.Parent = ButtonList
    Instance.new("UICorner", TabButton).CornerRadius = UDim.new(0, 8)

    local Page = Instance.new("ScrollingFrame")
    Page.Name = name .. "Page"
    Page.Size = UDim2.new(1, 0, 1, 0)
    Page.BackgroundTransparency = 1
    Page.Visible = false
    Page.ScrollBarThickness = 3
    Page.ScrollBarImageColor3 = THEME.Accent
    Page.Parent = Container
    local PageList = Instance.new("UIListLayout")
    PageList.Padding = UDim.new(0, 10)
    PageList.Parent = Page

    TabButton.MouseButton1Click:Connect(function()
        for _, v in pairs(Container:GetChildren()) do if v:IsA("ScrollingFrame") then v.Visible = false end end
        for _, v in pairs(ButtonList:GetChildren()) do
            if v:IsA("TextButton") then 
                TweenService:Create(v, TweenInfo.new(0.3), {TextColor3 = THEME.SecondaryText, BackgroundColor3 = THEME.Main}):Play()
            end
        end
        Page.Visible = true
        TweenService:Create(TabButton, TweenInfo.new(0.3), {TextColor3 = THEME.Text, BackgroundColor3 = THEME.Accent}):Play()
    end)
    return Page
end

local function createToggle(parent, text, callback)
    local ToggleFrame = Instance.new("Frame")
    ToggleFrame.Size = UDim2.new(1, -10, 0, 50)
    ToggleFrame.BackgroundColor3 = THEME.Background
    ToggleFrame.BorderSizePixel = 0
    ToggleFrame.Parent = parent
    Instance.new("UICorner", ToggleFrame).CornerRadius = UDim.new(0, 10)

    local Label = Instance.new("TextLabel")
    Label.Size = UDim2.new(0.7, 0, 1, 0)
    Label.Position = UDim2.new(0, 15, 0, 0)
    Label.BackgroundTransparency = 1
    Label.Text = text
    Label.TextColor3 = THEME.Text
    Label.TextSize = 14
    Label.Font = Enum.Font.GothamBold
    Label.TextXAlignment = Enum.TextXAlignment.Left
    Label.Parent = ToggleFrame

    local Box = Instance.new("Frame")
    Box.Size = UDim2.new(0, 50, 0, 26)
    Box.Position = UDim2.new(1, -65, 0.5, -13)
    Box.BackgroundColor3 = Color3.fromRGB(40, 40, 50)
    Box.Parent = ToggleFrame
    Instance.new("UICorner", Box).CornerRadius = UDim.new(1, 0)

    local Indicator = Instance.new("Frame")
    Indicator.Size = UDim2.new(0, 22, 0, 22)
    Indicator.Position = UDim2.new(0, 2, 0.5, -11)
    Indicator.BackgroundColor3 = Color3.fromRGB(200, 200, 200)
    Indicator.Parent = Box
    Instance.new("UICorner", Indicator).CornerRadius = UDim.new(1, 0)

    local enabled = false
    ToggleFrame.InputBegan:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 then
            enabled = not enabled
            local targetPos = enabled and UDim2.new(1, -24, 0.5, -11) or UDim2.new(0, 2, 0.5, -11)
            local targetColor = enabled and THEME.Green or Color3.fromRGB(40, 40, 50)
            TweenService:Create(Indicator, TweenInfo.new(0.2), {Position = targetPos}):Play()
            TweenService:Create(Box, TweenInfo.new(0.2), {BackgroundColor3 = targetColor}):Play()
            task.spawn(function() callback(enabled) end)
        end
    end)
end

local function createButton(parent, text, callback)
    local Btn = Instance.new("TextButton")
    Btn.Size = UDim2.new(1, -10, 0, 45)
    Btn.BackgroundColor3 = THEME.Background
    Btn.Text = text
    Btn.TextColor3 = THEME.Text
    Btn.Font = Enum.Font.GothamSemibold
    Btn.TextSize = 14
    Btn.Parent = parent
    Instance.new("UICorner", Btn).CornerRadius = UDim.new(0, 10)
    
    Btn.MouseButton1Click:Connect(function()
        local oldColor = Btn.BackgroundColor3
        Btn.BackgroundColor3 = THEME.Accent
        task.wait(0.1)
        Btn.BackgroundColor3 = oldColor
        task.spawn(callback)
    end)
end

-- SEKMELER
local TrollTab = createTab("Troll & Yıkım")
local TeleportTab = createTab("Işınlanma")
local PlayerTab = createTab("Karakter")
local ItemTab = createTab("Eşyalar")
local VisualTab = createTab("Görsel")

-- 1. TROLL & YIKIM (GuinRemote Odaklı)
createToggle(TrollTab, "Yıkım Modu (Server Çökertme)", function(state)
    _G.Destruction = state
    if not GuinRemote then return end
    while _G.Destruction do
        pcall(function()
            GuinRemote:FireServer(table.unpack({
                [1] = "Destruction", [2] = "Destruction", [3] = Vector3.new(0, -1, 0), [4] = Vector3.new(0, 0, 0),
                [5] = "Destruction", [6] = "Destruction", [7] = "Destruction", [8] = "Destruction",
                [9] = {[1] = true},
                [10] = {[1] = 25, [2] = Vector3.new(0.25, 0.25, 100), [3] = BrickColor.new('Bright yellow'), [4] = 0.25, [5] = Enum.Material.SmoothPlastic, [6] = 0.25},
                [11] = true, [12] = false
            }))
        end)
        task.wait(0.01)
    end
end)

createToggle(TrollTab, "Otomatik Ev Al/Sat (Lag)", function(state)
    _G.AutoBuyHouse = state
    if not GuinRemote then return end
    while _G.AutoBuyHouse do
        pcall(function()
            for i = 1, 25 do
                local house = "House"..i
                GuinRemote:FireServer(house, house, Vector3.new(0,-1,0), Vector3.new(0,0,0), house, house, _G.SelectedAudio, _G.SelectedAudio, {true}, {25, Vector3.new(0.25,0.25,100)}, true, false)
            end
        end)
        task.wait(0.5)
    end
end)

createToggle(TrollTab, "Yüksek Sesli Müzik (Loop)", function(state)
    _G.AutoAudio = state
    if not GuinRemote then return end
    while _G.AutoAudio do
        pcall(function() GuinRemote:FireServer("AudioPlay", "14145620056") end) -- Marş ID
        task.wait(1)
    end
end)

-- 2. IŞINLANMA (Teleport)
local Locations = {
    {"Spawn Noktası", CFrame.new(0, 10, 0)},
    {"Banka Kasası (İç)", CFrame.new(20, 15, 30)}, -- Örnek
    {"Polis Karakolu", CFrame.new(-20, 10, 50)}, -- Örnek
    {"Hastane Çatısı", CFrame.new(50, 50, 50)},
}

createButton(TeleportTab, "Tıkla Işınlan (CTRL + Click)", function()
    local mouse = player:GetMouse()
    mouse.Button1Down:Connect(function()
        if not UserInputService:IsKeyDown(Enum.KeyCode.LeftControl) then return end
        if mouse.Target then
            player.Character:MoveTo(mouse.Hit.p + Vector3.new(0, 3, 0))
        end
    end)
    game:GetService("StarterGui"):SetCore("SendNotification", {
        Title = "Aktif", Text = "CTRL basılı tutarak yere tıkla!", Duration = 3
    })
end)

createButton(TeleportTab, "Rastgele Oyuncuya Git", function()
    local players = Players:GetPlayers()
    local randomPlayer = players[math.random(1, #players)]
    if randomPlayer and randomPlayer ~= player and randomPlayer.Character then
        player.Character.HumanoidRootPart.CFrame = randomPlayer.Character.HumanoidRootPart.CFrame
    end
end)

-- 3. KARAKTER (Gizli Evlere Girmek İçin)
createToggle(PlayerTab, "Noclip (Duvardan Geç)", function(state)
    _G.Noclip = state
    RunService.Stepped:Connect(function()
        if _G.Noclip and player.Character then
            for _, v in pairs(player.Character:GetDescendants()) do
                if v:IsA("BasePart") then v.CanCollide = false end
            end
        end
    end)
end)

createToggle(PlayerTab, "Uçma Modu (Fly)", function(state)
    _G.Fly = state
    local bg = Instance.new("BodyGyro", player.Character.HumanoidRootPart)
    local bv = Instance.new("BodyVelocity", player.Character.HumanoidRootPart)
    bg.MaxTorque = Vector3.new(0,0,0)
    bv.MaxForce = Vector3.new(0,0,0)
    
    while _G.Fly do
        bg.MaxTorque = Vector3.new(9e9, 9e9, 9e9)
        bv.MaxForce = Vector3.new(9e9, 9e9, 9e9)
        bg.CFrame = camera.CFrame
        
        local speed = 50
        local vel = Vector3.new(0,0,0)
        if UserInputService:IsKeyDown(Enum.KeyCode.W) then vel = vel + camera.CFrame.LookVector * speed end
        if UserInputService:IsKeyDown(Enum.KeyCode.S) then vel = vel - camera.CFrame.LookVector * speed end
        if UserInputService:IsKeyDown(Enum.KeyCode.A) then vel = vel - camera.CFrame.RightVector * speed end
        if UserInputService:IsKeyDown(Enum.KeyCode.D) then vel = vel + camera.CFrame.RightVector * speed end
        bv.Velocity = vel
        task.wait()
    end
    bg:Destroy()
    bv:Destroy()
end)

createButton(PlayerTab, "Hızlandır (Speed 100)", function()
    player.Character.Humanoid.WalkSpeed = 100
end)

createToggle(PlayerTab, "Rainbow Avatar", function(state)
    _G.RainbowSkin = state
    while _G.RainbowSkin do
        local color = Color3.fromHSV(tick() % 5 / 5, 1, 1)
        for _, v in pairs(player.Character:GetChildren()) do
            if v:IsA("BodyColors") then
                v.HeadColor3 = color
                v.LeftArmColor3 = color
                v.RightArmColor3 = color
                v.TorsoColor3 = color
                v.LeftLegColor3 = color
                v.RightLegColor3 = color
            end
        end
        task.wait(0.1)
    end
end)

-- 4. EŞYALAR (Brookhaven Itemleri)
local brookhavenItems = {
    "BanHammer", "AK47", "Phone", "CreditCard", "Laptop", "Pizza", "C4", "Injection"
}

createToggle(ItemTab, "Otomatik Item Spam", function(state)
    _G.SpamItems = state
    if not GuinRemote then return end
    while _G.SpamItems do
        for _, item in pairs(brookhavenItems) do
            pcall(function() GuinRemote:FireServer(item, item, Vector3.new(0,0,0), Vector3.new(0,0,0), item) end)
        end
        task.wait(0.1)
    end
end)

for _, item in pairs(brookhavenItems) do
    createButton(ItemTab, item .. " Al", function()
        if not GuinRemote then return end
        pcall(function() GuinRemote:FireServer(item, item, Vector3.new(0,0,0), Vector3.new(0,0,0), item) end)
    end)
end

-- 5. GÖRSEL
createButton(VisualTab, "FullBright (Karanlık Yok)", function()
    Lighting.Brightness = 2
    Lighting.ClockTime = 12
    Lighting.FogEnd = 100000
    Lighting.GlobalShadows = false
    Lighting.OutdoorAmbient = Color3.fromRGB(128, 128, 128)
end)

createButton(VisualTab, "X-Ray (Duvarları Gör)", function()
    for _, v in pairs(workspace:GetDescendants()) do
        if v:IsA("BasePart") then v.Transparency = 0.5 end
    end
end)

-- Menü Hareketi
local dragging, dragInput, dragStart, startPos
MainFrame.InputBegan:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 then
        dragging = true
        dragStart = input.Position
        startPos = MainFrame.Position
    end
end)
UserInputService.InputChanged:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseMovement then dragInput = input end
end)
RunService.RenderStepped:Connect(function()
    if dragging and dragInput then
        local delta = dragInput.Position - dragStart
        MainFrame.Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X, startPos.Y.Scale, startPos.Y.Offset + delta.Y)
    end
end)
UserInputService.InputEnded:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 then dragging = false end
end)

-- Kapatıp Açma
UserInputService.InputBegan:Connect(function(input, gpe)
    if gpe then return end
    if input.KeyCode == Enum.KeyCode.RightShift then
        _G.MenuVisible = not _G.MenuVisible
        MainFrame.Visible = _G.MenuVisible
    end
end)

-- Açılış
MainFrame.Size = UDim2.new(0,0,0,0)
TweenService:Create(MainFrame, TweenInfo.new(0.6, Enum.EasingStyle.Back), {Size = UDim2.new(0, 650, 0, 480)}):Play()
