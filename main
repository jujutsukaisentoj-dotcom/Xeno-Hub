--[[ 
    XENOHUB ULTIMATE - V20 (FIRE & ADS EDITION)
    Analiz Edilen Dosyalar: AllGamepasses, AdvertisementsController, GamepassUnlockController.
    √ñzellikler: Yangƒ±n Butonu (Fire), Full Maƒüaza, CMDR, Ara√ß Hƒ±zlandƒ±rma.
]]

local Players = game:GetService("Players")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local UserInputService = game:GetService("UserInputService")
local TweenService = game:GetService("TweenService")
local CoreGui = game:GetService("CoreGui")
local RunService = game:GetService("RunService")
local StarterGui = game:GetService("StarterGui")
local Workspace = game:GetService("Workspace")

local lp = Players.LocalPlayer
local ParentFolder = (gethui and gethui()) or CoreGui

-- ============================================================================== --
-- AYARLAR VE RENKLER
-- ============================================================================== --
local Config = {
    Theme = Color3.fromRGB(255, 85, 85), -- Fire kƒ±rmƒ±zƒ±sƒ± tema
    Secondary = Color3.fromRGB(25, 25, 35),
    Background = Color3.fromRGB(15, 15, 20),
    EspActive = false,
    InfJump = false,
    FireMode = false
}

-- ============================================================================== --
-- √áEKƒ∞RDEK BYPASS FONKSƒ∞YONLARI (Dosya Analizine G√∂re)
-- ============================================================================== --

local function Notify(title, text)
    StarterGui:SetCore("SendNotification", {
        Title = title;
        Text = text;
        Duration = 5;
    })
end

local function ActivatePremiumFeatures()
    local success, err = pcall(function()
        -- 1. Gamepass Controller Hook (Sahiplik Sim√ºlasyonu)
        local GamepassModule = require(ReplicatedStorage.Modules.Client.UI.Gamepass.GamepassController)
        local UnlockController = require(ReplicatedStorage.Modules.Client.UI.GamepassUnlockController)
        
        -- Fonksiyonlarƒ± Override Et
        GamepassModule.OwnsGamepass = function() return true end
        GamepassModule.HasPass = function() return true end
        UnlockController.OwnsGamepass = function() return true end

        -- 2. Ads (Reklam) Controller Hook (Video ƒ∞zlenmi≈ü Gibi G√∂ster)
        local AdController = require(ReplicatedStorage.Modules.Client.Ads.AdvertisementsController)
        local AdConstants = require(ReplicatedStorage.Modules.Shared.Advertisements.AdvertisementsConstants)
        
        AdController.IsFakedVideo = function() return true end
        
        -- 3. T√ºm Gamepass Listesini Tarayƒ±p 'Unlocked' Yap
        local SharedPasses = require(ReplicatedStorage.Modules.Shared.PlayerData.Gamepasses)
        for name, data in pairs(SharedPasses.All or {}) do
            if type(data) == "table" then
                data.Unlocked = true
                data.__GAMEPASS = true
                -- Sisteme bu gamepass'in reklamla alƒ±ndƒ±ƒüƒ± sinyalini g√∂nder
                if AdController.OnRewardedAdClaimed then
                    AdController.OnRewardedAdClaimed:Fire(data.id)
                end
            end
        end

        -- 4. Extend Unlock (Ev S√ºre Uzatma)
        local ExtendController = require(ReplicatedStorage.Modules.Client.Ads.ExtendUnlockController)
        if ExtendController.ShowExtendCurrentHousePanel then
            ExtendController.ShowExtendCurrentHousePanel(true) -- Paneli zorla g√∂ster ama bypasslƒ±
        end
    end)

    if success then
        Notify("XenoHub V20", "Premium, Yangƒ±n ve Reklamlar Bypass Edildi!")
    else
        warn("Bypass Hatasƒ±: " .. tostring(err))
    end
end

-- YANGIN BUTONU MANTIƒûI (ON_DEMAND_FIRE)
local function ToggleFireButton()
    pcall(function()
        -- 1. Gamepass Yetkisini Ver
        local SharedPasses = require(ReplicatedStorage.Modules.Shared.PlayerData.Gamepasses)
        if SharedPasses.All.ON_DEMAND_FIRE then
            SharedPasses.All.ON_DEMAND_FIRE.Unlocked = true
        end
        
        -- 2. UI √úzerindeki Gizli Butonu Bul ve A√ß
        local playerGui = lp:WaitForChild("PlayerGui")
        local mainGui = playerGui:FindFirstChild("MainGUI")
        
        if mainGui then
            -- Oyunun UI aƒüacƒ±nda genelde HouseControls i√ßinde olur
            for _, v in pairs(mainGui:GetDescendants()) do
                if v:IsA("ImageButton") and (v.Name:match("Fire") or v.Image:match("Fire")) then
                    v.Visible = true
                    v.Active = true
                    v.Selectable = true
                    -- Butonu kƒ±rmƒ±zƒ±msƒ± parlat
                    v.ImageColor3 = Color3.fromRGB(255, 100, 100)
                end
            end
        end
        Notify("Yangƒ±n Modu", "Yangƒ±n butonlarƒ± UI √ºzerinde g√∂r√ºn√ºr yapƒ±ldƒ±.")
    end)
end

-- ============================================================================== --
-- UI ARAY√úZ√ú (MODERN TASARIM)
-- ============================================================================== --

if ParentFolder:FindFirstChild("XenoFireV20") then ParentFolder.XenoFireV20:Destroy() end
local ScreenGui = Instance.new("ScreenGui", ParentFolder)
ScreenGui.Name = "XenoFireV20"

local Main = Instance.new("Frame", ScreenGui)
Main.Size = UDim2.new(0, 680, 0, 450)
Main.Position = UDim2.new(0.5, -340, 0.5, -225)
Main.BackgroundColor3 = Config.Background
Main.BorderSizePixel = 0
Instance.new("UICorner", Main).CornerRadius = UDim.new(0, 14)
local Stroke = Instance.new("UIStroke", Main)
Stroke.Color = Config.Theme
Stroke.Thickness = 2.5

-- Sol Men√º
local Sidebar = Instance.new("Frame", Main)
Sidebar.Size = UDim2.new(0, 190, 1, 0)
Sidebar.BackgroundColor3 = Config.Secondary
Instance.new("UICorner", Sidebar).CornerRadius = UDim.new(0, 14)

local Title = Instance.new("TextLabel", Sidebar)
Title.Text = "XENOHUB\nFIRE ED."
Title.Size = UDim2.new(1, 0, 0, 80)
Title.BackgroundTransparency = 1
Title.TextColor3 = Config.Theme
Title.Font = Enum.Font.GothamBlack
Title.TextSize = 22

-- Tab Container
local TabContainer = Instance.new("ScrollingFrame", Sidebar)
TabContainer.Position = UDim2.new(0, 0, 0, 90)
TabContainer.Size = UDim2.new(1, 0, 1, -100)
TabContainer.BackgroundTransparency = 1
TabContainer.ScrollBarThickness = 0
local TabList = Instance.new("UIListLayout", TabContainer)
TabList.HorizontalAlignment = Enum.HorizontalAlignment.Center
TabList.Padding = UDim.new(0, 8)

-- ƒ∞√ßerik Alanƒ±
local Content = Instance.new("Frame", Main)
Content.Position = UDim2.new(0, 200, 0, 10)
Content.Size = UDim2.new(1, -210, 1, -20)
Content.BackgroundTransparency = 1

local tabs = {}

local function CreateTab(name)
    local btn = Instance.new("TextButton", TabContainer)
    btn.Size = UDim2.new(0.85, 0, 0, 40)
    btn.BackgroundColor3 = Config.Theme
    btn.BackgroundTransparency = 1
    btn.Text = name
    btn.TextColor3 = Color3.fromRGB(180, 180, 180)
    btn.Font = Enum.Font.GothamBold
    btn.TextSize = 13
    Instance.new("UICorner", btn).CornerRadius = UDim.new(0, 8)
    
    local page = Instance.new("ScrollingFrame", Content)
    page.Size = UDim2.new(1, 0, 1, 0)
    page.BackgroundTransparency = 1
    page.Visible = false
    page.ScrollBarThickness = 3
    local pl = Instance.new("UIListLayout", page)
    pl.Padding = UDim.new(0, 10)
    
    btn.MouseButton1Click:Connect(function()
        for _, t in pairs(tabs) do 
            t.p.Visible = false 
            t.b.BackgroundTransparency = 1
            t.b.TextColor3 = Color3.fromRGB(180, 180, 180)
        end
        page.Visible = true
        btn.BackgroundTransparency = 0.8
        btn.TextColor3 = Color3.new(1,1,1)
    end)
    
    if #tabs == 0 then 
        page.Visible = true 
        btn.BackgroundTransparency = 0.8 
        btn.TextColor3 = Color3.new(1,1,1) 
    end
    table.insert(tabs, {p = page, b = btn})
    return page
end

local function CreateButton(parent, text, callback)
    local btn = Instance.new("TextButton", parent)
    btn.Size = UDim2.new(0.98, 0, 0, 45)
    btn.BackgroundColor3 = Color3.fromRGB(30, 30, 40)
    btn.Text = text
    btn.TextColor3 = Color3.new(1,1,1)
    btn.Font = Enum.Font.GothamSemibold
    btn.TextSize = 14
    Instance.new("UICorner", btn).CornerRadius = UDim.new(0, 8)
    
    -- Efekt
    local s = Instance.new("UIStroke", btn)
    s.Color = Config.Theme
    s.Transparency = 0.7
    s.ApplyStrokeMode = Enum.ApplyStrokeMode.Border
    
    btn.MouseButton1Click:Connect(function()
        s.Transparency = 0
        task.wait(0.1)
        s.Transparency = 0.7
        callback()
    end)
end

local function CreateToggle(parent, text, callback)
    local frame = Instance.new("Frame", parent)
    frame.Size = UDim2.new(0.98, 0, 0, 45)
    frame.BackgroundColor3 = Color3.fromRGB(30, 30, 40)
    Instance.new("UICorner", frame).CornerRadius = UDim.new(0, 8)
    
    local lbl = Instance.new("TextLabel", frame)
    lbl.Size = UDim2.new(0.7, 0, 1, 0)
    lbl.Position = UDim2.new(0.05, 0, 0, 0)
    lbl.BackgroundTransparency = 1
    lbl.Text = text
    lbl.TextColor3 = Color3.new(1,1,1)
    lbl.Font = Enum.Font.GothamSemibold
    lbl.TextSize = 14
    lbl.TextXAlignment = Enum.TextXAlignment.Left
    
    local btn = Instance.new("TextButton", frame)
    btn.Size = UDim2.new(0, 50, 0, 24)
    btn.Position = UDim2.new(0.82, 0, 0.5, -12)
    btn.BackgroundColor3 = Color3.fromRGB(50, 50, 60)
    btn.Text = ""
    Instance.new("UICorner", btn).CornerRadius = UDim.new(1, 0)
    
    local circle = Instance.new("Frame", btn)
    circle.Size = UDim2.new(0, 20, 0, 20)
    circle.Position = UDim2.new(0, 2, 0.5, -10)
    circle.BackgroundColor3 = Color3.new(1,1,1)
    Instance.new("UICorner", circle).CornerRadius = UDim.new(1, 0)
    
    local state = false
    btn.MouseButton1Click:Connect(function()
        state = not state
        local goalPos = state and UDim2.new(1, -22, 0.5, -10) or UDim2.new(0, 2, 0.5, -10)
        local goalCol = state and Config.Theme or Color3.fromRGB(50, 50, 60)
        TweenService:Create(circle, TweenInfo.new(0.2), {Position = goalPos}):Play()
        TweenService:Create(btn, TweenInfo.new(0.2), {BackgroundColor3 = goalCol}):Play()
        callback(state)
    end)
end

-- ============================================================================== --
-- SEKME ƒ∞√áERƒ∞KLERƒ∞
-- ============================================================================== --

local MainTab = CreateTab("üî• Ana Panel")
local WorldTab = CreateTab("üåç D√ºnya & Ev")
local PlayerTab = CreateTab("üë§ Oyuncu")

-- [ANA PANEL]
CreateButton(MainTab, "FULL BYPASS (Hepsini A√ß)", ActivatePremiumFeatures)
CreateButton(MainTab, "YANGIN BUTONUNU A√á (Fire)", ToggleFireButton)
CreateButton(MainTab, "CMDR Konsolunu A√ß", function()
    pcall(function()
        local Cmdr = ReplicatedStorage:FindFirstChild("CmdrClient", true)
        if Cmdr then require(Cmdr):HandleEvent("OpenConsole") end
    end)
end)

-- [D√úNYA & EV]
CreateButton(WorldTab, "T√ºm Ev Kilitlerini Kaldƒ±r", function()
    -- House Unlock Logic
    local Extension = require(ReplicatedStorage.Modules.Client.Ads.ExtendUnlockController)
    Extension.ShowExtendCurrentHousePanel(true)
    Notify("Ev Sistemi", "Ev kilidi panel √ºzerinden kaldƒ±rƒ±ldƒ±.")
end)
CreateButton(WorldTab, "Bankayƒ± Otomatik Soy", function()
    if lp.Character and lp.Character:FindFirstChild("HumanoidRootPart") then
        lp.Character.HumanoidRootPart.CFrame = CFrame.new(-442, 23, -283)
        Notify("Banka", "Kasa dairesine ƒ±≈üƒ±nlandƒ±nƒ±z. C4'√º hazƒ±rlayƒ±n!")
    end
end)
CreateButton(WorldTab, "Gizli Ajans √úss√ºne Git", function()
    if lp.Character then lp.Character.HumanoidRootPart.CFrame = CFrame.new(-932, 12, -446) end
end)

-- [OYUNCU]
CreateToggle(PlayerTab, "Sƒ±nƒ±rsƒ±z Zƒ±plama", function(s) Config.InfJump = s end)
CreateToggle(PlayerTab, "Duvar Arkasƒ± G√∂rme (ESP)", function(s) Config.EspActive = s end)
CreateButton(PlayerTab, "Hƒ±zƒ± Arttƒ±r (Speed)", function()
    if lp.Character then lp.Character.Humanoid.WalkSpeed = 45 end
end)

-- ============================================================================== --
-- LOOPLAR VE Sƒ∞STEM
-- ============================================================================== --

UserInputService.JumpRequest:Connect(function()
    if Config.InfJump and lp.Character then lp.Character.Humanoid:ChangeState(3) end
end)

RunService.RenderStepped:Connect(function()
    if Config.EspActive then
        for _, p in pairs(Players:GetPlayers()) do
            if p ~= lp and p.Character and not p.Character:FindFirstChild("FireESP") then
                local h = Instance.new("Highlight", p.Character)
                h.Name = "FireESP"
                h.FillColor = Config.Theme
                h.OutlineColor = Color3.new(1,1,1)
            end
        end
    else
        for _, p in pairs(Players:GetPlayers()) do
            if p.Character and p.Character:FindFirstChild("FireESP") then
                p.Character.FireESP:Destroy()
            end
        end
    end
end)

-- Men√º S√ºr√ºkleme
local dragging, dragStart, startPos
Main.InputBegan:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 then
        dragging = true
        dragStart = input.Position
        startPos = Main.Position
        input.Changed:Connect(function()
            if input.UserInputState == Enum.UserInputState.End then dragging = false end
        end)
    end
end)
Main.InputChanged:Connect(function(input)
    if dragging and input.UserInputType == Enum.UserInputType.MouseMovement then
        local delta = input.Position - dragStart
        Main.Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X, startPos.Y.Scale, startPos.Y.Offset + delta.Y)
    end
end)

-- Kapatma Tu≈üu
local CloseBtn = Instance.new("TextButton", ScreenGui)
CloseBtn.Size = UDim2.new(0, 40, 0, 40)
CloseBtn.Position = UDim2.new(0, 15, 0.5, 0)
CloseBtn.BackgroundColor3 = Config.Theme
CloseBtn.Text = "X"
CloseBtn.TextColor3 = Color3.new(1,1,1)
Instance.new("UICorner", CloseBtn).CornerRadius = UDim.new(1,0)
CloseBtn.MouseButton1Click:Connect(function() Main.Visible = not Main.Visible end)

ActivatePremiumFeatures() -- Ba≈ülangƒ±√ßta otamatik bypass dene
