local TweenService = game:GetService("TweenService")
local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local UserInputService = game:GetService("UserInputService")
local CoreGui = game:GetService("CoreGui")

local player = Players.LocalPlayer
local mouse = player:GetMouse()

-- Remote Event Tanımlaması (Orijinal koddan gelen)
local GuinRemote = game:GetService("ReplicatedStorage"):WaitForChild("GuinRemote")

-- Renk Paleti (Modern Neon Mor)
local THEME = {
    Main = Color3.fromRGB(15, 15, 20),
    Accent = Color3.fromRGB(145, 90, 230),
    Text = Color3.fromRGB(255, 255, 255),
    SecondaryText = Color3.fromRGB(180, 180, 180),
    Background = Color3.fromRGB(25, 25, 35),
    Outline = Color3.fromRGB(45, 45, 60)
}

-- Global Kontrol Değişkenleri
_G.Destruction = false
_G.AutoBuyHouse = false
_G.AutoAudio = false
_G.MenuVisible = true
_G.SelectedAudio = "14145620056" -- Varsayılan ses

-- GUI Oluşturma
local ScreenGui = Instance.new("ScreenGui")
ScreenGui.Name = "XenoHub_V2"
ScreenGui.ResetOnSpawn = false
ScreenGui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling

if gethui then
    ScreenGui.Parent = gethui()
elseif syn and syn.protect_gui then
    syn.protect_gui(ScreenGui)
    ScreenGui.Parent = CoreGui
else
    ScreenGui.Parent = CoreGui
end

-- Ana Panel
local MainFrame = Instance.new("Frame")
MainFrame.Name = "MainFrame"
MainFrame.Size = UDim2.new(0, 550, 0, 380)
MainFrame.Position = UDim2.new(0.5, -275, 0.5, -190)
MainFrame.BackgroundColor3 = THEME.Main
MainFrame.BorderSizePixel = 0
MainFrame.ClipsDescendants = true
MainFrame.Parent = ScreenGui

local UICorner = Instance.new("UICorner")
UICorner.CornerRadius = UDim.new(0, 10)
UICorner.Parent = MainFrame

local UIStroke = Instance.new("UIStroke")
UIStroke.Thickness = 2
UIStroke.Color = THEME.Accent
UIStroke.Transparency = 0.5
UIStroke.Parent = MainFrame

-- Yan Menü (Sidebar)
local Sidebar = Instance.new("Frame")
Sidebar.Name = "Sidebar"
Sidebar.Size = UDim2.new(0, 160, 1, 0)
Sidebar.BackgroundColor3 = THEME.Background
Sidebar.BorderSizePixel = 0
Sidebar.Parent = MainFrame

local SideCorner = Instance.new("UICorner")
SideCorner.CornerRadius = UDim.new(0, 10)
SideCorner.Parent = Sidebar

-- Başlık
local Title = Instance.new("TextLabel")
Title.Size = UDim2.new(1, 0, 0, 50)
Title.BackgroundTransparency = 1
Title.Text = "XENOHUB V2"
Title.TextColor3 = THEME.Accent
Title.TextSize = 20
Title.Font = Enum.Font.GothamBold
Title.Parent = Sidebar

-- Buton Konteynırı
local ButtonList = Instance.new("ScrollingFrame")
ButtonList.Size = UDim2.new(1, -10, 1, -100)
ButtonList.Position = UDim2.new(0, 5, 0, 55)
ButtonList.BackgroundTransparency = 1
ButtonList.ScrollBarThickness = 0
ButtonList.Parent = Sidebar

local UIList = Instance.new("UIListLayout")
UIList.Padding = UDim.new(0, 5)
UIList.Parent = ButtonList

-- Alt Bilgi (Keybind info)
local KeyInfo = Instance.new("TextLabel")
KeyInfo.Size = UDim2.new(1, 0, 0, 30)
KeyInfo.Position = UDim2.new(0, 0, 1, -35)
KeyInfo.BackgroundTransparency = 1
KeyInfo.Text = "[R-SHIFT] Menü"
KeyInfo.TextColor3 = THEME.SecondaryText
KeyInfo.TextSize = 12
KeyInfo.Font = Enum.Font.Gotham
KeyInfo.Parent = Sidebar

-- İçerik Alanı
local Container = Instance.new("Frame")
Container.Name = "Container"
Container.Size = UDim2.new(1, -170, 1, -20)
Container.Position = UDim2.new(0, 165, 0, 10)
Container.BackgroundTransparency = 1
Container.Parent = MainFrame

-- Fonksiyonlar: Sayfa Oluşturma
local function createTab(name)
    local TabButton = Instance.new("TextButton")
    TabButton.Size = UDim2.new(1, 0, 0, 35)
    TabButton.BackgroundColor3 = THEME.Main
    TabButton.BorderSizePixel = 0
    TabButton.Text = "  " .. name
    TabButton.TextColor3 = THEME.SecondaryText
    TabButton.TextSize = 13
    TabButton.Font = Enum.Font.GothamSemibold
    TabButton.TextXAlignment = Enum.TextXAlignment.Left
    TabButton.Parent = ButtonList

    local TabCorner = Instance.new("UICorner")
    TabCorner.CornerRadius = UDim.new(0, 6)
    TabCorner.Parent = TabButton

    local Page = Instance.new("ScrollingFrame")
    Page.Name = name .. "Page"
    Page.Size = UDim2.new(1, 0, 1, 0)
    Page.BackgroundTransparency = 1
    Page.Visible = false
    Page.ScrollBarThickness = 2
    Page.ScrollBarImageColor3 = THEME.Accent
    Page.Parent = Container

    local PageList = Instance.new("UIListLayout")
    PageList.Padding = UDim.new(0, 8)
    PageList.Parent = Page

    TabButton.MouseButton1Click:Connect(function()
        for _, v in pairs(Container:GetChildren()) do
            if v:IsA("ScrollingFrame") then v.Visible = false end
        end
        for _, v in pairs(ButtonList:GetChildren()) do
            if v:IsA("TextButton") then 
                TweenService:Create(v, TweenInfo.new(0.3), {TextColor3 = THEME.SecondaryText, BackgroundColor3 = THEME.Main}):Play()
            end
        end
        Page.Visible = true
        TweenService:Create(TabButton, TweenInfo.new(0.3), {TextColor3 = THEME.Text, BackgroundColor3 = THEME.Accent}):Play()
    end)

    return Page
end

-- Fonksiyonlar: Toggle Oluşturma
local function createToggle(parent, text, callback)
    local ToggleFrame = Instance.new("Frame")
    ToggleFrame.Size = UDim2.new(1, -10, 0, 40)
    ToggleFrame.BackgroundColor3 = THEME.Background
    ToggleFrame.BorderSizePixel = 0
    ToggleFrame.Parent = parent

    local Cor = Instance.new("UICorner")
    Cor.CornerRadius = UDim.new(0, 6)
    Cor.Parent = ToggleFrame

    local Label = Instance.new("TextLabel")
    Label.Size = UDim2.new(1, -50, 1, 0)
    Label.Position = UDim2.new(0, 10, 0, 0)
    Label.BackgroundTransparency = 1
    Label.Text = text
    Label.TextColor3 = THEME.Text
    Label.TextSize = 13
    Label.Font = Enum.Font.Gotham
    Label.TextXAlignment = Enum.TextXAlignment.Left
    Label.Parent = ToggleFrame

    local Box = Instance.new("Frame")
    Box.Size = UDim2.new(0, 34, 0, 18)
    Box.Position = UDim2.new(1, -44, 0.5, -9)
    Box.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
    Box.Parent = ToggleFrame
    local BoxCor = Instance.new("UICorner")
    BoxCor.CornerRadius = UDim.new(1, 0)
    BoxCor.Parent = Box

    local Indicator = Instance.new("Frame")
    Indicator.Size = UDim2.new(0, 14, 0, 14)
    Indicator.Position = UDim2.new(0, 2, 0.5, -7)
    Indicator.BackgroundColor3 = Color3.fromRGB(200, 200, 200)
    Indicator.Parent = Box
    local IndCor = Instance.new("UICorner")
    IndCor.CornerRadius = UDim.new(1, 0)
    IndCor.Parent = Indicator

    local enabled = false
    ToggleFrame.InputBegan:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 then
            enabled = not enabled
            local targetPos = enabled and UDim2.new(1, -16, 0.5, -7) or UDim2.new(0, 2, 0.5, -7)
            local targetColor = enabled and THEME.Accent or Color3.fromRGB(50, 50, 50)
            
            TweenService:Create(Indicator, TweenInfo.new(0.2), {Position = targetPos}):Play()
            TweenService:Create(Box, TweenInfo.new(0.2), {BackgroundColor3 = targetColor}):Play()
            
            task.spawn(function() callback(enabled) end)
        end
    end)
end

-- Fonksiyonlar: Buton Oluşturma
local function createButton(parent, text, callback)
    local Btn = Instance.new("TextButton")
    Btn.Size = UDim2.new(1, -10, 0, 35)
    Btn.BackgroundColor3 = THEME.Background
    Btn.Text = text
    Btn.TextColor3 = THEME.Text
    Btn.Font = Enum.Font.GothamSemibold
    Btn.TextSize = 13
    Btn.Parent = parent
    
    Instance.new("UICorner").Parent = Btn
    
    Btn.MouseButton1Click:Connect(function()
        Btn.BackgroundColor3 = THEME.Accent
        task.wait(0.1)
        Btn.BackgroundColor3 = THEME.Background
        task.spawn(callback)
    end)
end

-- Sayfalar
local MainTab = createTab("Ana Menü")
local ItemTab = createTab("Eşyalar")
local AudioTab = createTab("Sesler")

-- ÖZELLİKLER (ORİJİNAL KOD ENTEGRASYONU)

-- 1. Yıkım Modu (Destruction)
createToggle(MainTab, "Yıkım Modu (Destruction)", function(state)
    _G.Destruction = state
    while _G.Destruction do
        pcall(function()
            GuinRemote:FireServer(table.unpack({
                [1] = "Destruction",
                [2] = "Destruction",
                [3] = Vector3.new(0, -1, 0),
                [4] = Vector3.new(0, 0, 0),
                [5] = "Destruction",
                [6] = "Destruction",
                [7] = "Destruction",
                [8] = "Destruction",
                [9] = {[1] = true},
                [10] = {
                    [1] = 25,
                    [2] = Vector3.new(0.25, 0.25, 100),
                    [3] = BrickColor.new('Bright yellow'),
                    [4] = 0.25,
                    [5] = Enum.Material.SmoothPlastic,
                    [6] = 0.25,
                },
                [11] = true,
                [12] = false,
            }))
        end)
        task.wait(0.1)
    end
end)

-- 2. Otomatik Ev Al
createToggle(MainTab, "Otomatik Ev Al", function(state)
    _G.AutoBuyHouse = state
    while _G.AutoBuyHouse do
        pcall(function()
            GuinRemote:FireServer(table.unpack({
                [1] = "BuyHouse",
                [2] = "BuyHouse",
                [3] = Vector3.new(0, -1, 0),
                [4] = Vector3.new(0, 0, 0),
                [5] = "BuyHouse",
                [6] = "BuyHouse",
                [7] = _G.SelectedAudio,
                [8] = _G.SelectedAudio,
                [9] = {[1] = true},
                [10] = {
                    [1] = 25,
                    [2] = Vector3.new(0.25, 0.25, 100),
                    [3] = BrickColor.new('Bright yellow'),
                    [4] = 0.25,
                    [5] = Enum.Material.SmoothPlastic,
                    [6] = 0.25,
                },
                [11] = true,
                [12] = false,
            }))
        end)
        task.wait(0.1)
    end
end)

-- 3. Eşya Verme (Items)
local items = {"Hammer", "Screwdriver", "Wrench", "Axe", "Saw"}
for _, item in pairs(items) do
    createButton(ItemTab, item .. " Al", function()
        pcall(function()
            GuinRemote:FireServer(item, item, Vector3.new(0,0,0), Vector3.new(0,0,0), item)
        end)
    end)
end

-- 4. Ses Kontrolü
createToggle(AudioTab, "Sürekli Ses Çal", function(state)
    _G.AutoAudio = state
    while _G.AutoAudio do
        pcall(function()
            GuinRemote:FireServer("AudioPlay", _G.SelectedAudio)
        end)
        task.wait(0.5)
    end
end)

-- Sürüklenebilir Yapma
local dragging, dragInput, dragStart, startPos
MainFrame.InputBegan:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 then
        dragging = true
        dragStart = input.Position
        startPos = MainFrame.Position
    end
end)

UserInputService.InputChanged:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseMovement then
        dragInput = input
    end
end)

RunService.RenderStepped:Connect(function()
    if dragging and dragInput then
        local delta = dragInput.Position - dragStart
        MainFrame.Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X, startPos.Y.Scale, startPos.Y.Offset + delta.Y)
    end
end)

UserInputService.InputEnded:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 then
        dragging = false
    end
end)

-- Menü Açma Kapama (RightShift)
UserInputService.InputBegan:Connect(function(input, gpe)
    if gpe then return end
    if input.KeyCode == Enum.KeyCode.RightShift then
        _G.MenuVisible = not _G.MenuVisible
        MainFrame.Visible = _G.MenuVisible
    end
end)

-- Açılış Animasyonu
MainFrame.Size = UDim2.new(0, 0, 0, 0)
TweenService:Create(MainFrame, TweenInfo.new(0.5, Enum.EasingStyle.Back), {Size = UDim2.new(0, 550, 0, 380)}):Play()
